let questions = [
    {
    numb: 1,
    question: "쮺u치l es el objetivo de la Normativa Interna de Circulaci칩n de Metro de Madrid?",
    answer: "Regulaci칩n de la circulaci칩n de manera eficaz y segura tanto por la red principal como por la secundaria del metro de Madrid",
    options: [
      'Regulaci칩n de la circulaci칩n de manera eficaz y segura solo por la red principal del metro de Madrid',
      'Regulaci칩n de la circulaci칩n de manera eficaz y segura tanto por la red principal como por la secundaria del metro de Madrid',
      'Regulaci칩n de la circulaci칩n de manera eficaz y segura solo por la red secundaria del metro de Madrid',
      'Ninguna de las anteriores'
    ]
    },
    {
    numb: 2,
    question: "쮼n qu칠 lugares es de obligado cumplimiento la NIC?",
    answer: 'En toda la red operada por Metro de Madrid, excepto para aquellas explotaciones que tengan una Normativa propia',
    options: [
      'En todas las dependencias e instalaciones de Metro de Madrid',
      'En todas las explotaciones que tengan una Normativa propia',
      'En toda la red operada por Metro de Madrid, excepto para aquellas explotaciones que tengan una Normativa propia',
      'Solo en las situaciones especialmente sensibles desde la perspectiva de la seguridad'
  
    ]
    },
    {
    numb: 3,
    question:"쯈ui칠nes deben cumplir la NIC?",
    answer: 'Los trabajadores de Metro de Madrid, que intervengan en la circulaci칩n de trenes por la Red de Metro',
    options: [
      'Los trabajadores de Metro de Madrid, que intervengan en la circulaci칩n de trenes por la Red de Metro',
      'Todos los ciudadanos que usen el metro de Madrid',
      'Solo los conductores de trenes',
      'Ninguna de las anteriores'
  
    ]
    },
    {
        numb: 4,
        question:"쯈u칠 se considera fuera del 치mbito de aplicaci칩n de la NIC?",
        answer: 'Las dependencias e instalaciones de Metro de Madrid cuando permanezcan cerradas a la explotaci칩n',
        options: [
          'Las dependencias e instalaciones de Metro de Madrid cuando permanezcan cerradas a la explotaci칩n',
          'El personal que trabaje en las dependencias e instalaciones de Metro de Madrid cuando permanezcan cerradas a la explotaci칩n',
          'Las dependencias e instalaciones de Metro de Madrid cuando est칠n en explotaci칩n',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 5,
        question:"쮺u치l es el procedimiento para modificar o ampliar la NIC?",
        answer: '칔nicamente por circulares de Direcci칩n',
        options: [
          'A trav칠s de un procedimiento judicial',
          'Solo mediante la aprobaci칩n del Consejo de Administraci칩n de Metro de Madrid',
          '칔nicamente por circulares de Direcci칩n',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 6,
        question:"쮺칩mo se distribuye la NIC?",
        answer: 'Por el sistema de hojas intercambiables para facilitar su sustituci칩n',
        options: [
          'Por correo postal',
          'Por correo electr칩nico',
          'Por el sistema de hojas intercambiables para facilitar su sustituci칩n',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 7,
        question:"쯈ui칠n es el m치ximo responsable de la explotaci칩n del servicio de Metro de Madrid?",
        answer: 'El PCC',
        options: [
          'El Consejo de Administraci칩n de Metro de Madrid',
          'El PCC',
          'El equipo de mantenimiento de material m칩vil e instalaciones',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 8,
        question:"Qu칠 es el PCC",
        answer: 'El encargado de la supervisi칩n, control y regulaci칩n de la circulaci칩n',
        options: [
          'Un equipo de mantenimiento de material m칩vil e instalaciones',
          'El encargado de la supervisi칩n, control y regulaci칩n de la circulaci칩n',
          'El responsable operativo ubicado en las l칤neas, estaciones, dep칩sitos o cocheras',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 9,
        question:"쮺u치l es el objetivo de la se침alizaci칩n?",
        answer: 'Regular la circulaci칩n de trenes con seguridad',
        options: [
          'Regular el tr치fico en general',
          'Regular la circulaci칩n de trenes con seguridad',
          'Dar 칩rdenes a los trabajadores',
          'Se침alizar las v칤as secundarias'
        ]
      },
      {
        numb: 10,
        question:"쮺칩mo deben ser las se침ales para los conductores de los trenes?",
        answer: 'Deben ser perceptibles en el sentido de la circulaci칩n',
        options: [
          'Deben ser audibles',
          'Deben ser visibles solo de cerca',
          'Deben ser perceptibles en el sentido de la circulaci칩n',
          'Deben ser se침ales luminosas'
        ]
      },
      {
        numb: 11,
        question:"쯈u칠 deben hacer los trabajadores en relaci칩n con las 칩rdenes de la se침alizaci칩n?",
        answer: 'Obedecerlas estrictamente y de inmediato',
        options: [
          'Desobedecerlas si no est치n de acuerdo',
          'Obedecerlas solo si es conveniente para ellos',
          'Obedecerlas estrictamente y de inmediato',
          'Desobedecerlas si no hay una excepci칩n en la NIC'
        ]
      },
      {
        numb: 12,
        question:"쯈u칠 se침ales son las que deben conocer los maquinistas?",
        answer: 'Se침ales fijas ferroviarias',
        options: [
          'Se침ales de carretera',
          'Se침ales luminosas de emergencia',
          'Se침ales de tr치fico mar칤timo',
          'Se침ales fijas ferroviarias'
        ]
      },
      {
        numb:13,
        question:"쯈u칠 se debe hacer si un conductor encuentra varias se침ales o carteles en un mismo lugar?",
        answer: 'Obedecer todas las 칩rdenes si son compatibles',
        options: [
          'Obedecer solo la indicaci칩n m치s restrictiva',
          'Obedecer todas las 칩rdenes si son compatibles',
          'Obedecer todas las se침ales sin excepci칩n',
          'Obedecer solo la 칰ltima se침al en el camino'
        ]
      },
      {numb: 14,
        question:"쮺u치l es el orden de prioridad entre los distintos tipos de se침ales y carteles?",
        answer: 'Las se침ales gestuales de emergencia, la se침alizaci칩n circunstancial mediante indicadores luminosos o carteles que modifiquen la utilizaci칩n normal de la v칤a, las se침ales fijas ferroviarias y las se침ales de limitaci칩n de velocidad',
        options: [
          'Las se침ales de tracci칩n el칠ctrica, las se침ales gestuales de emergencia, las se침ales de limitaci칩n de velocidad',
          'Las se침ales fijas ferroviarias, las se침ales de limitaci칩n de velocidad, las se침ales gestuales de emergencia',
          'Las se침ales gestuales de emergencia, la se침alizaci칩n circunstancial mediante indicadores luminosos o carteles que modifiquen la utilizaci칩n normal de la v칤a, las se침ales fijas ferroviarias y las se침ales de limitaci칩n de velocidad',
          'Las se침ales ac칰sticas, las se침ales de tracci칩n el칠ctrica, las se침ales fijas de emergencia'
        ]
      },
      {
        numb: 15,
        question:"쯈u칠 debe hacer un trabajador si detecta una aver칤a o irregularidad en la se침alizaci칩n o en los aparatos de v칤a?",
        answer: 'Comunicarlo de inmediato al PCC o al responsable operativo',
        options: [
          'Ignorar la aver칤a',
          'Comunicarlo de inmediato al PCC o al responsable operativo',
          'Esperar a que otro trabajador lo detecte',
          'Quedarse junto a la se침al o aparato averiado para arreglarlo'
        ]
      },
      {
        numb: 16,
        question:"쯈u칠 son las se침ales gestuales de emergencia?",
        answer: 'Se침ales que se realizan agitando ostensiblemente cualquier objeto o los brazos',
        options: [
          'Se침ales fijas ferroviarias que indican una emergencia',
          'Se침ales ac칰sticas que se usan en caso de emergencia',
          'Se침ales luminosas que indican una emergencia',
          'Se침ales que se realizan agitando ostensiblemente cualquier objeto o los brazos'
        ]
      },
      {
        numb: 17,
        question:"쮼n qu칠 situaciones se deben utilizar las se침ales gestuales?",
        answer: 'se utilizar치 exclusivamente en caso de emergencia',
        options: [
          'Para regular el tr치fico engeneral',
          'Para comunicar una aver칤a en la v칤a' ,
          'para saludar al maquinista',
          'se utilizar치 exclusivamente en caso de emergencia'
        ]
      },
      {numb: 18,
        question:"쮺u치ntos tipos de indicadores luminosos existen?",
        answer: 'Dos',
        options: [
            'Uno',
            'Dos',
            'Tres',
            'Cuatro'
        ]
      },
      {
        numb: 19,
        question:"쯈u칠 son los indicadores luminosos port치tiles?",
        answer: 'Se침ales que indican la presencia de personas o situaciones en la plataforma de v칤a',
        options: [
          'Se침ales que informan sobre la regulaci칩n de la circulaci칩n',
          'Luces que indican el tiempo que falta para la salida de un tren',
          'Se침ales que indican la presencia de personas o situaciones en la plataforma de v칤a',
          'Farolas que iluminan la v칤a f칠rrea'
        ]
      },
      {
        numb: 20,
        question:"쮺u치l es el prop칩sito de la baliza roja?",
        answer: 'Indicar la prohibici칩n absoluta de rebasarla cuando se sit칰a en la plataforma de v칤a',
        options: [
          'Indicar el inicio de precauci칩n',
          'Indicar la presencia de trabajadores en la franja de borde de and칠n',
          'Indicar la prohibici칩n absoluta de rebasarla cuando se sit칰a en la plataforma de v칤a',
          'Indicar la finalizaci칩n de precauci칩n'
        ]
      },
      {
        numb: 21,
        question:"쮺u치l es la altura m칤nima a la que debe estar colocada la baliza roja?",
        answer: '1,5 m',
        options: [
            '1,5 cm',
            '1,5 m',
            '15 cm',
            '15 m'
        ]
      },
      {
        numb: 22,
        question:"쯈u칠 es el farol amarillo?",
        answer: 'Indica el inicio de precauci칩n',
        options: [
          'Indica la finalizaci칩n de precauci칩n',
          'Indica la presencia de trabajadores en la franja de borde de and칠n',
          'Indica el inicio de precauci칩n',
          'Indica el inicio de la zona de obras'
        ]
      },
      {
        numb: 23,
        question:"쮻칩nde se sit칰a el farol amarillo?",
        answer: 'Entre el carril exterior de la v칤a y el paramento lateral del t칰nel o el l칤mite de la plataforma de v칤a',
        options: [
          'En la plataforma de v칤a',
          'Entre el carril exterior de la v칤a y el paramento lateral del t칰nel o el l칤mite de la plataforma de v칤a',
          'En el pi침칩n de algunas estaciones',
          'En los t칰neles'
        ]
      },
      {
        numb: 24,
        question:"쯈u칠 indica el farol azul?",
        answer: 'Indica el inicio de la zona de obras',
        options: [
          'Indica la finalizaci칩n de precauci칩n',
          'Indica la presencia de trabajadores en la franja de borde de and칠n',
         ' Indica el inicio de precauci칩n',
          'Indica el inicio de la zona de obras'
        ]
      },
      {
        numb: 25,
        question:"쮺u치l es el objeto de los carteles?",
        answer: 'Informar sobre circunstancias especiales de la circulaci칩n',
        options: [
          'Informar sobre estaciones y trenes',
          'Informar sobre instalaciones',
          'Informar sobre circunstancias especiales de la circulaci칩n',
          'Todas las anteriores'
        ]
      },
      {
        numb: 26,
        question:"쮻칩nde se colocan los carteles?",
        answer: 'En los pi침ones de las estaciones',
        options: [
          'En los t칰neles',
          'En los pi침ones de las estaciones',
          'En los andenes',
          'En las v칤as'
        ]
      },
      {
        numb: 27,
        question:'쯈u칠 informaci칩n proporciona un cartel avisador de precauci칩n pr칩xima?',
        answer: 'Advierte de la proximidad de una zona de trabajo',
        options: [
          'Indica la presencia de personal en la plataforma de v칤a',
          'Obliga a seleccionar el modo de conducci칩n',
          'Advierte de la proximidad de una zona de trabajo',
          'Todas las anteriores'
        ]
      },
      {
        numb: 28,
        question:"쮺u치l es el tama침o aproximado del cartel avisador de precauci칩n pr칩xima?",
        answer: '80X40 cm',
        options: [
          '40X80 cm',
          '80X40 cm',
          '30X80 cm',
          '10X80 cm'
        ]
      },
      {
        numb:29,
        question:"쯈u칠 color tiene la parte superior que compone el cartel avisador de precauci칩n pr칩xima?",
        answer: 'Amarillo',
        options: [
          'Azul',
          'Verde',
          'Amarillo',
          'Rojo'
        ]
      },
      {
        numb:30,
        question:"쯈u칠 inscripci칩n aparece en letras blancas sobre fondo azul en el cartel avisador de precauci칩n pr칩xima?",
        answer: '"SELECCIONAR A.T.P."',
        options: [
          '"SELECCIONAR A.T.P."',
          '"춰PRECAUCI칍N! ZONA DE OBRAS"',
          '"춰PRECAUCI칍N! PERSONAL EN PLATAFORMA DE V칈A"',
          'Ninguna de las anteriores'
        ]
      },
      {
        numb: 31,
        question:'쮻칩nde se sit칰a el cartel avisador de precauci칩n pr칩xima?',
        answer: 'En el pi침칩n de salida de la estaci칩n anterior donde se encuentra el primer cartel precautorio',
        options: [
          'En la estaci칩n donde se encuentra un cartel precautorio',
          'En el pi침칩n de salida de la estaci칩n anterior donde se encuentra el primer cartel precautorio',
          'En la estaci칩n donde se encuentra el 칰ltimo cartel precautorio',
          'En la estaci칩n donde no hay cartel precautorio'
        ]
      },
      {
        numb: 32,
        question:"쯈u칠 tipo de cartel es el precautorio por la presencia de personal en la plataforma de v칤a?",
        answer: 'De advertencia de peligro',
        options: [
          'De informaci칩n',
          'De advertencia de peligro',
          'De prohibici칩n',
          'De recomendaci칩n'
        ]
      },
      {
        numb:33,
        question:"쮻칩nde se sit칰a el cartel precautorio por la presencia de personal en la plataforma de v칤a?",
        answer: 'En los pi침ones de salida de las estaciones y en las bocas de acceso al t칰nel desde los dep칩sitos o cocheras',
        options: [
          'En los pi침ones de salida de las estaciones y en las bocas de acceso al t칰nel desde los dep칩sitos o cocheras',
          'En los pi침ones de salida de las estaciones',
          'En las v칤as',
          'En los t칰neles'
        ]
      },
      {
        numb:34,
        question:"쯈u칠 tipo de cartel es el precautorio por la existencia de una zona de obras sin presencia de personal en la plataforma de v칤a?",
        answer: 'De advertencia de peligro',
        options: [
          'De circulaci칩n',
          'De informaci칩n',
          'De prohibici칩n',
          'De advertencia de peligro'
        ]
      },
];
//selecting all required elements
const start_btn = document.querySelector(".start_btn button");
const info_box = document.querySelector(".info_box");
const exit_btn = info_box.querySelector(".buttons .quit");
const continue_btn = info_box.querySelector(".buttons .restart");
const quiz_box = document.querySelector(".quiz_box");
const result_box = document.querySelector(".result_box");
const option_list = document.querySelector(".option_list");
const time_line = document.querySelector("header .time_line");
const timeText = document.querySelector(".timer .time_left_txt");
const timeCount = document.querySelector(".timer .timer_sec");

// if startQuiz button clicked
start_btn.onclick = ()=>{
    info_box.classList.add("activeInfo"); //show info box
}

// if exitQuiz button clicked
exit_btn.onclick = ()=>{
    info_box.classList.remove("activeInfo"); //hide info box
}

// if continueQuiz button clicked
continue_btn.onclick = ()=>{
    info_box.classList.remove("activeInfo"); //hide info box
    quiz_box.classList.add("activeQuiz"); //show quiz box
    showQuetions(0); //calling showQestions function
    queCounter(1); //passing 1 parameter to queCounter
    startTimer(40); //calling startTimer function
    startTimerLine(0); //calling startTimerLine function
}

let timeValue =  40;
let que_count = 0;
let que_numb = 1;
let userScore = 0;
let counter;
let counterLine;
let widthValue = 0;

const restart_quiz = result_box.querySelector(".buttons .restart");
const quit_quiz = result_box.querySelector(".buttons .quit");

// if restartQuiz button clicked
restart_quiz.onclick = ()=>{
    quiz_box.classList.add("activeQuiz"); //show quiz box
    result_box.classList.remove("activeResult"); //hide result box
    timeValue = 15; 
    que_count = 0;
    que_numb = 1;
    userScore = 0;
    widthValue = 0;
    showQuetions(que_count); //calling showQestions function
    queCounter(que_numb); //passing que_numb value to queCounter
    clearInterval(counter); //clear counter
    clearInterval(counterLine); //clear counterLine
    startTimer(timeValue); //calling startTimer function
    startTimerLine(widthValue); //calling startTimerLine function
    timeText.textContent = "Tiempo"; //change the text of timeText to Time Left
    next_btn.classList.remove("show"); //hide the next button
}

// if quitQuiz button clicked
quit_quiz.onclick = ()=>{
    window.location.reload(); //reload the current window
}

const next_btn = document.querySelector("footer .next_btn");
const bottom_ques_counter = document.querySelector("footer .total_que");

// if Next Que button clicked
next_btn.onclick = ()=>{
    if(que_count < questions.length - 1){ //if question count is less than total question length
        que_count++; //increment the que_count value
        que_numb++; //increment the que_numb value
        showQuetions(que_count); //calling showQestions function
        queCounter(que_numb); //passing que_numb value to queCounter
        clearInterval(counter); //clear counter
        clearInterval(counterLine); //clear counterLine
        startTimer(timeValue); //calling startTimer function
        startTimerLine(widthValue); //calling startTimerLine function
        timeText.textContent = "Tiempo"; //change the timeText to Time Left
        next_btn.classList.remove("show"); //hide the next button
    }else{
        clearInterval(counter); //clear counter
        clearInterval(counterLine); //clear counterLine
        showResult(); //calling showResult function
    }
}

// getting questions and options from array
function showQuetions(index){
    const que_text = document.querySelector(".que_text");

    //creating a new span and div tag for question and option and passing the value using array index
    let que_tag = '<span>'+ questions[index].numb + ". " + questions[index].question +'</span>';
    // que_tag= questions[index].sort(()=> Math.random()-.5);

    let option_tag = '<div class="option"><span>'+ questions[index].options[0] +'</span></div>'
    + '<div class="option"><span>'+ questions[index].options[1] +'</span></div>'
    + '<div class="option"><span>'+ questions[index].options[2] +'</span></div>'
    + '<div class="option"><span>'+ questions[index].options[3] +'</span></div>';
    que_text.innerHTML = que_tag; //adding new span tag inside que_tag
    option_list.innerHTML = option_tag; //adding new div tag inside option_tag
    
    const option = option_list.querySelectorAll(".option");

    // set onclick attribute to all available options
    for(i=0; i < option.length; i++){
        option[i].setAttribute("onclick", "optionSelected(this)");
    }
}
// creating the new div tags which for icons
let tickIconTag = '<div class="icon tick"><i class="fas fa-check"></i></div>';
let crossIconTag = '<div class="icon cross"><i class="fas fa-times"></i></div>';

//if user clicked on option
function optionSelected(answer){
    clearInterval(counter); //clear counter
    clearInterval(counterLine); //clear counterLine
    let userAns = answer.textContent; //getting user selected option
    let correcAns = questions[que_count].answer; //getting correct answer from array
    const allOptions = option_list.children.length; //getting all option items
    
    if(userAns == correcAns){ //if user selected option is equal to array's correct answer
        userScore += 1; //upgrading score value with 1
        answer.classList.add("correct"); //adding green color to correct selected option
        answer.insertAdjacentHTML("beforeend", tickIconTag); //adding tick icon to correct selected option
        console.log("Correct Answer");
        console.log("Your correct options = " + userScore);
    }else{
        answer.classList.add("incorrect"); //adding red color to correct selected option
        answer.insertAdjacentHTML("beforeend", crossIconTag); //adding cross icon to correct selected option
        console.log("Wrong Answer");

        for(i=0; i < allOptions; i++){
            if(option_list.children[i].textContent == correcAns){ //if there is an option which is matched to an array answer 
                option_list.children[i].setAttribute("class", "option correct"); //adding green color to matched option
                option_list.children[i].insertAdjacentHTML("beforeend", tickIconTag); //adding tick icon to matched option
                console.log("Auto selected correct answer.");
            }
        }
    }
    for(i=0; i < allOptions; i++){
        option_list.children[i].classList.add("disabled"); //once user select an option then disabled all options
    }
    next_btn.classList.add("show"); //show the next button if user selected any option
}

function showResult(){
    info_box.classList.remove("activeInfo"); //hide info box
    quiz_box.classList.remove("activeQuiz"); //hide quiz box
    result_box.classList.add("activeResult"); //show result box
    const scoreText = result_box.querySelector(".score_text");
    if (userScore > 3){ // if user scored more than 3
        //creating a new span tag and passing the user score number and total question number
        let scoreTag = '<span>Enhorabuena! 游꿀, has obtenido <p>'+ userScore +'</p> de <p>'+ questions.length +'</p></span>';
        scoreText.innerHTML = scoreTag;  //adding new span tag inside score_Text
    }
    else if(userScore > 1){ // if user scored more than 1
        let scoreTag = '<span>Genial 游땙, obtuvistes <p>'+ userScore +'</p> de <p>'+ questions.length +'</p></span>';
        scoreText.innerHTML = scoreTag;
    }
    else{ // if user scored less than 1
        let scoreTag = '<span>Lo siento 游땛, solo obtuviste <p>'+ userScore +'</p> de <p>'+ questions.length +'</p></span>';
        scoreText.innerHTML = scoreTag;
    }
}

function startTimer(time){
    counter = setInterval(timer, 1000);
    function timer(){
        timeCount.textContent = time; //changing the value of timeCount with time value
        time--; //decrement the time value
        if(time < 9){ //if timer is less than 9
            let addZero = timeCount.textContent; 
            timeCount.textContent = "0" + addZero; //add a 0 before time value
        }
        if(time < 0){ //if timer is less than 0
            clearInterval(counter); //clear counter
            timeText.textContent = "Tiempo"; //change the time text to time off
            const allOptions = option_list.children.length; //getting all option items
            let correcAns = questions[que_count].answer; //getting correct answer from array
            for(i=0; i < allOptions; i++){
                if(option_list.children[i].textContent == correcAns){ //if there is an option which is matched to an array answer
                    option_list.children[i].setAttribute("class", "option correct"); //adding green color to matched option
                    option_list.children[i].insertAdjacentHTML("beforeend", tickIconTag); //adding tick icon to matched option
                    console.log("Time Off: Auto selected correct answer.");
                }
            }
            for(i=0; i < allOptions; i++){
                option_list.children[i].classList.add("disabled"); //once user select an option then disabled all options
            }
            next_btn.classList.add("show"); //show the next button if user selected any option
        }
    }
}

function startTimerLine(time){
    counterLine = setInterval(timer, 55);
    function timer(){
        time += 1; //upgrading time value with 1
        time_line.style.width = time + "px"; //increasing width of time_line with px by time value
        if(time > 560){ //if time value is greater than 549
            clearInterval(counterLine); //clear counterLine
        }
    }
}

function queCounter(index){
   
    let totalQueCounTag = '<span><p>'+ index +'</p> de <p>'+ questions.length +'</p> Preguntas</span>';
    bottom_ques_counter.innerHTML = totalQueCounTag; 
}